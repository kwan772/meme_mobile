{"ast":null,"code":"var _jsxFileName = \"/Users/kevii/Desktop/memeApp/my-app/src/App.js\",\n    _s = $RefreshSig$();\n\nimport './App.css';\nimport React, { useState, useEffect } from 'react';\nimport memeBGM from \"./assets/memeBGM.mp3\";\nimport useSound from 'use-sound';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [meme, setMeme] = useState([]);\n  const [currentMeme, setCurrentMeme] = useState(2);\n  const [nextMeme, setNextMeme] = useState(currentMeme + 1);\n  const [seconds, setSeconds] = useState(15);\n  const [displayCurrent, setDisplayCurrent] = useState(true);\n  const [length, setLength] = useState();\n  const CLOCK = 15;\n  const WEEK_IN_MS = 604800000;\n  const TEN_MIN_IN_MS = 600000;\n  const [play] = useSound(memeBGM);\n  const myRef = /*#__PURE__*/React.createRef();\n  useEffect(() => {\n    getData();\n    myRef.current.click();\n  }, []);\n  useEffect(() => {\n    setTimeout(() => {\n      if (seconds !== 0) {\n        setSeconds(seconds - 1);\n      } else {\n        if (displayCurrent) {\n          setDisplayCurrent(false);\n\n          if (length > nextMeme + 1) {\n            setCurrentMeme(nextMeme + 1);\n\n            while (!meme[currentMeme].media && meme[currentMeme].media === '') {\n              setCurrentMeme(nextMeme + 1);\n            }\n          } else {\n            setMeme(shuffle(meme));\n            setCurrentMeme(0);\n          }\n        } else {\n          setDisplayCurrent(true);\n\n          if (length > currentMeme + 1) {\n            setNextMeme(currentMeme + 1);\n\n            while (!meme[nextMeme].media && meme[nextMeme].media === '') {\n              setCurrentMeme(nextMeme + 1);\n            }\n          } else {\n            setMeme(shuffle(meme));\n            setNextMeme(0);\n          }\n        }\n\n        setSeconds(CLOCK);\n      }\n    }, 1000);\n  }, [seconds]);\n  useEffect(() => {\n    console.log(meme);\n  }, [meme]);\n\n  function shuffle(array) {\n    let currentIndex = array.length;\n    let randomIndex;\n\n    while (currentIndex != 0) {\n      randomIndex = Math.floor(Math.random() * currentIndex);\n      currentIndex--;\n      [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];\n    }\n\n    return array;\n  }\n\n  const getData = () => {\n    fetch(\"/members\").then(res => res.json()).then(data => {\n      setLength(Object.keys(data.title).length);\n      let shuffleMeme = [];\n\n      for (var i = 0; i < Object.keys(data.title).length; i++) {\n        //   setMeme(preState => [\n        //     ...preState, {media:data.media['?',i],\n        //   score:data.score['?',i],\n        // title:data.title['?',i]}\n        //   ])\n        shuffleMeme.push({\n          media: data.media[('?', i)],\n          score: data.score[('?', i)],\n          title: data.title[('?', i)]\n        });\n      }\n\n      setMeme(shuffle(shuffleMeme));\n    });\n  };\n\n  const updateData = () => {\n    fetch(\"/updateMeme\");\n  };\n\n  useEffect(() => {\n    const currentTime = new Date().getTime(); //current unix timestamp\n\n    const execTime = new Date().setHours(22, 9, 0); //API call time = today at 20:00\n\n    let timeLeft;\n\n    if (currentTime < execTime) {\n      //it's currently earlier than 20:00\n      timeLeft = execTime - currentTime;\n    } else {\n      //it's currently later than 20:00, schedule for tomorrow at 20:00\n      timeLeft = execTime + WEEK_IN_MS - currentTime;\n    }\n\n    console.log(timeLeft);\n    setTimeout(function () {\n      updateData();\n      setTimeout(function () {\n        getData();\n      }, TEN_MIN_IN_MS);\n      setInterval(function () {\n        updateData();\n        setTimeout(function () {\n          getData();\n        }, TEN_MIN_IN_MS);\n      }, WEEK_IN_MS); //repeat every week\n    }, timeLeft); //wait until 20:00 as calculated above\n  }, []);\n  useEffect(() => {\n    if (meme.length > 0) {\n      fetch(\"/checkImage?src=\" + meme[currentMeme].media).then(res => {\n        return res.json();\n      }).then(isFound => {\n        console.log(isFound);\n\n        if (isFound === 404) {\n          if (length > currentMeme + 2) {\n            setCurrentMeme(currentMeme + 1);\n            setNextMeme(currentMeme + 2);\n            console.log(\"skipped\");\n          } else {\n            setMeme(shuffle(meme));\n            setCurrentMeme(0);\n          }\n        }\n      });\n    }\n  }, [currentMeme]);\n  useEffect(() => {\n    if (meme.length > 0) {\n      fetch(\"/checkImage?src=\" + meme[nextMeme].media).then(res => {\n        return res.json();\n      }).then(isFound => {\n        console.log(isFound);\n\n        if (isFound === 404) {\n          if (length > nextMeme + 2) {\n            setNextMeme(nextMeme + 1);\n            setCurrentMeme(nextMeme + 2);\n            console.log(\"skipped\");\n          } else {\n            setMeme(shuffle(meme));\n            setNextMeme(0);\n          }\n        }\n      });\n    }\n  }, [nextMeme]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      ref: myRef,\n      onClick: play,\n      children: \"Boop!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"App-header\",\n      children: [meme[currentMeme + 1] ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: displayCurrent ? null : {\n            display: 'none'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: meme[currentMeme].title.replace(\"fuck\", \"****\").replace(\"shit\", \"****\").replace(\"Bitch\", \"*****\").replace(\"Fuck\", \"****\").replace(\"Shit\", \"****\").replace(\"Bitch\", \"*****\").replace(\"FUCK\", \"****\").replace(\"SHIT\", \"****\").replace(\"BITCH\", \"*****\").replace(\"cunt\", \"****\").replace(\"CUNT\", \"****\").replace(\"Cunt\", \"****\").replace(\"nigger\", \"*****\").replace(\"NIGGER\", \"*****\").replace(\"Nigger\", \"******\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            alt: \"current meme\",\n            src: meme[currentMeme].media,\n            onError: e => {\n              if (length > currentMeme + 1) {\n                if (currentMeme > nextMeme) {\n                  setCurrentMeme(currentMeme + 1);\n                }\n\n                console.log(meme[currentMeme].media);\n                console.log(\"error img\");\n                e.target.onerror = null;\n                e.target.src = meme[currentMeme].media;\n              } else {\n                setMeme(shuffle(meme));\n                setCurrentMeme(0);\n                console.log(\"error img\");\n                e.target.onerror = null;\n                e.target.src = meme[currentMeme].media;\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: displayCurrent ? {\n            display: 'none'\n          } : null,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: meme[nextMeme].title.replace(\"fuck\", \"****\").replace(\"shit\", \"****\").replace(\"bitch\", \"*****\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            alt: \"next meme\",\n            src: meme[nextMeme].media,\n            onError: e => {\n              if (length > nextMeme + 1) {\n                setNextMeme(nextMeme + 1);\n                console.log(meme[nextMeme].media);\n                console.log(\"error img\");\n                e.target.onerror = null;\n                e.target.src = meme[nextMeme].media;\n              } else {\n                setMeme(shuffle(meme));\n                setNextMeme(0);\n                console.log(\"error img\");\n                e.target.onerror = null;\n                e.target.src = meme[nextMeme].media;\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 36\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"timer\",\n        children: seconds\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 200,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"MCbcL5TESaM34cBmGkJsJe+5zKg=\", false, function () {\n  return [useSound];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/kevii/Desktop/memeApp/my-app/src/App.js"],"names":["React","useState","useEffect","memeBGM","useSound","App","meme","setMeme","currentMeme","setCurrentMeme","nextMeme","setNextMeme","seconds","setSeconds","displayCurrent","setDisplayCurrent","length","setLength","CLOCK","WEEK_IN_MS","TEN_MIN_IN_MS","play","myRef","createRef","getData","current","click","setTimeout","media","shuffle","console","log","array","currentIndex","randomIndex","Math","floor","random","fetch","then","res","json","data","Object","keys","title","shuffleMeme","i","push","score","updateData","currentTime","Date","getTime","execTime","setHours","timeLeft","setInterval","isFound","display","replace","e","target","onerror","src"],"mappings":"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","sourcesContent":["import './App.css';\nimport React, { useState, useEffect } from 'react';\nimport memeBGM from \"./assets/memeBGM.mp3\";\nimport useSound from 'use-sound';\n\n\nfunction App() {\n  const [meme,setMeme] = useState([])\n  const [currentMeme,setCurrentMeme] = useState(2)\n  const [nextMeme,setNextMeme] = useState(currentMeme+1)\n  const [seconds,setSeconds] = useState(15)\n  const [displayCurrent, setDisplayCurrent] = useState(true)\n  const [length,setLength] = useState()\n  const CLOCK = 15\n  const WEEK_IN_MS = 604800000\n  const TEN_MIN_IN_MS = 600000\n\n  const [play] = useSound(memeBGM)\n  const myRef = React.createRef()\n\n\n\n  useEffect(() => {\n      getData()\n      myRef.current.click()\n  },[])\n\n\n  useEffect(() => {\n    setTimeout(() => {\n      if(seconds!==0){\n      setSeconds(seconds-1)}\n      else{\n        if(displayCurrent){\n          setDisplayCurrent(false)\n          if(length>(nextMeme+1)){\n\n            setCurrentMeme(nextMeme+1)\n            while(!meme[currentMeme].media && meme[currentMeme].media===''){\n              setCurrentMeme(nextMeme+1)\n            }\n          \n          }\n          else{\n            setMeme(shuffle(meme))\n            setCurrentMeme(0)\n          }\n\n        }\n        else{\n          setDisplayCurrent(true)\n          if(length>(currentMeme+1)){\n            setNextMeme(currentMeme+1)\n            while(!meme[nextMeme].media && meme[nextMeme].media===''){\n              setCurrentMeme(nextMeme+1)\n            }\n          \n          }\n          else{\n            setMeme(shuffle(meme))\n            setNextMeme(0)\n          }\n        }\n        setSeconds(CLOCK)\n        \n      }\n    }, 1000);\n    \n  }, [seconds])\n\n  useEffect(()=>{\n    console.log(meme)\n  },[meme])\n\n  function shuffle(array) {\n    let currentIndex = array.length\n    let randomIndex\n\n    while (currentIndex != 0) {\n\n      randomIndex = Math.floor(Math.random() * currentIndex);\n      currentIndex--;\n\n      [array[currentIndex], array[randomIndex]] = [\n        array[randomIndex], array[currentIndex]];\n    }\n    \n    return array\n      \n    }\n\n    const getData = () => {\n      fetch(\"/members\").then(\n        res => res.json()\n      )\n      .then(data => {\n        setLength(Object.keys(data.title).length)\n        let shuffleMeme = []\n        for (var i =0; i<Object.keys(data.title).length; i++){\n      //   setMeme(preState => [\n      //     ...preState, {media:data.media['?',i],\n      //   score:data.score['?',i],\n      // title:data.title['?',i]}\n      //   ])\n  \n          shuffleMeme.push({media:data.media['?',i],\n             score:data.score['?',i],\n           title:data.title['?',i]})\n  \n  \n      }\n      setMeme(shuffle(shuffleMeme))\n      })\n    }\n\n    const updateData = () => {\n      fetch(\"/updateMeme\")\n    }\n\n    useEffect(() => {\n\n      const currentTime = new Date().getTime();  //current unix timestamp\n      const execTime = new Date().setHours(22,9,0);  //API call time = today at 20:00\n      let timeLeft;\n      if(currentTime < execTime) {\n        //it's currently earlier than 20:00\n        timeLeft = execTime - currentTime;\n      } else {\n        //it's currently later than 20:00, schedule for tomorrow at 20:00\n        timeLeft = execTime + WEEK_IN_MS - currentTime\n      }\n      console.log(timeLeft)\n      \n      setTimeout(function() {\n\n        updateData()\n          setTimeout(function() {\n            getData()\n          }, TEN_MIN_IN_MS)\n\n        setInterval(function() {\n          updateData()\n          setTimeout(function() {\n            getData()\n          }, TEN_MIN_IN_MS)\n    \n        }, WEEK_IN_MS);  //repeat every week\n      }, timeLeft);  //wait until 20:00 as calculated above\n    },[])\n\n    useEffect(() => {\n      if(meme.length > 0) {\n      fetch(\"/checkImage?src=\"+meme[currentMeme].media)\n      .then(res => {\n        return res.json()\n      })\n      .then(isFound => {\n        console.log(isFound)\n        if (isFound === 404){\n          if(length>(currentMeme+2)){\n          setCurrentMeme(currentMeme+1)\n          setNextMeme(currentMeme+2)\n          console.log(\"skipped\")\n          }\n          else{\n            setMeme(shuffle(meme))\n            setCurrentMeme(0)\n          }\n        }\n      }) \n    }\n    },[currentMeme])\n\n    useEffect(() => {\n      if(meme.length > 0) {\n        fetch(\"/checkImage?src=\"+meme[nextMeme].media)\n        .then(res => {\n          return res.json()\n        })\n        .then(isFound => {\n          console.log(isFound)\n          if (isFound === 404){\n            if(length>(nextMeme+2)){\n              setNextMeme(nextMeme+1)\n              setCurrentMeme(nextMeme+2)\n              console.log(\"skipped\")\n            }\n            else{\n              setMeme(shuffle(meme))\n              setNextMeme(0)\n            }\n          }\n        })\n      }\n       \n    },[nextMeme])\n\n\n  return (\n    <div className=\"App\">\n\n<button ref={myRef} onClick={play}>Boop!</button>\n      <header className=\"App-header\">\n      {meme[currentMeme+1]?        <div>\n\n        <div style={displayCurrent?null:{display:'none'}}>\n            <h3>{meme[currentMeme].title.replace(\"fuck\",\"****\").replace(\"shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"Fuck\",\"****\").replace(\"Shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"FUCK\",\"****\").replace(\"SHIT\",\"****\").replace(\"BITCH\",\"*****\").replace(\"cunt\",\"****\").replace(\"CUNT\",\"****\").replace(\"Cunt\",\"****\").replace(\"nigger\",\"*****\").replace(\"NIGGER\",\"*****\").replace(\"Nigger\",\"******\")}</h3>\n            <img alt=\"current meme\" src={meme[currentMeme].media} onError={(e) => {\n              if(length>(currentMeme+1)){\n              if(currentMeme > nextMeme){\n                setCurrentMeme(currentMeme+1)\n              }\n              \n              console.log(meme[currentMeme].media)\n              console.log(\"error img\")\n              e.target.onerror = null\n              e.target.src=meme[currentMeme].media\n            }\n            else{\n              setMeme(shuffle(meme))\n              setCurrentMeme(0)\n              console.log(\"error img\")\n              e.target.onerror = null\n              e.target.src=meme[currentMeme].media\n            }}}></img>\n            </div>\n\n            <div style={displayCurrent?{display:'none'}:null}>\n            <h3>{meme[nextMeme].title.replace(\"fuck\",\"****\").replace(\"shit\",\"****\").replace(\"bitch\",\"*****\")}</h3>\n            <img alt=\"next meme\" src={meme[nextMeme].media} onError={(e) => {\n              if(length>(nextMeme+1)){\n                setNextMeme(nextMeme+1)\n                console.log(meme[nextMeme].media)\n                console.log(\"error img\")\n                e.target.onerror = null\n                e.target.src=meme[nextMeme].media\n              }\n              else{\n                setMeme(shuffle(meme))\n                setNextMeme(0)\n                console.log(\"error img\")\n                e.target.onerror = null\n                e.target.src=meme[nextMeme].media\n              }\n            }}></img>\n            </div>\n          </div>:null}\n        <span className=\"timer\">{seconds}</span>\n      </header>\n\n      {/* <img src={\"https://i.redd.it/rs7pju6muo881.jpg\"} \n      onError={({ currentTarget }) => {\n        currentTarget.onerror = null; // prevents looping\n        currentTarget.src=\"https://i.redd.it/u6anbsaoed381.jpg\";\n      }}\n      \n    ></img> */}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}