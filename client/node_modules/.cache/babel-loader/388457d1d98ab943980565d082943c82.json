{"ast":null,"code":"import _slicedToArray from\"/Users/kevii/Desktop/git-meme-stream/meme-stream/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./App.css';import React,{useState,useEffect}from'react';import memeBGM from\"./assets/memeBGM.mp3\";import useSound from'use-sound';import bellSound from\"./assets/bell.mp3\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),meme=_useState2[0],setMeme=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),currentMeme=_useState4[0],setCurrentMeme=_useState4[1];var _useState5=useState(currentMeme+1),_useState6=_slicedToArray(_useState5,2),nextMeme=_useState6[0],setNextMeme=_useState6[1];var _useState7=useState(15),_useState8=_slicedToArray(_useState7,2),seconds=_useState8[0],setSeconds=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),displayCurrent=_useState10[0],setDisplayCurrent=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),length=_useState12[0],setLength=_useState12[1];var CLOCK=15;var WEEK_IN_MS=604800000;var TEN_MIN_IN_MS=600000;var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),onMusic=_useState14[0],setOnMusic=_useState14[1];var _useState15=useState(new Audio(memeBGM)),_useState16=_slicedToArray(_useState15,2),bgm=_useState16[0],setBgm=_useState16[1];var play=function play(){if(onMusic){setOnMusic(false);bgm.pause();}else{setOnMusic(true);bgm.play();bgm.loop=true;}};useEffect(function(){getData();},[]);useEffect(function(){setTimeout(function(){if(seconds!==0){setSeconds(seconds-1);}else{if(displayCurrent){setDisplayCurrent(false);if(length>nextMeme+1){setCurrentMeme(nextMeme+1);while(!meme[currentMeme].media&&meme[currentMeme].media===''){setCurrentMeme(nextMeme+1);}}else{setMeme(shuffle(meme));setCurrentMeme(0);}}else{setDisplayCurrent(true);if(length>currentMeme+1){setNextMeme(currentMeme+1);while(!meme[nextMeme].media&&meme[nextMeme].media===''){setCurrentMeme(nextMeme+1);}}else{setMeme(shuffle(meme));setNextMeme(0);}}setSeconds(CLOCK);}},1000);},[seconds]);useEffect(function(){console.log(meme);},[meme]);function shuffle(array){var currentIndex=array.length;var randomIndex;while(currentIndex!=0){randomIndex=Math.floor(Math.random()*currentIndex);currentIndex--;var _ref=[array[randomIndex],array[currentIndex]];array[currentIndex]=_ref[0];array[randomIndex]=_ref[1];}return array;}var getData=function getData(){fetch(\"/members\").then(function(res){return res.json();}).then(function(data){setLength(Object.keys(data.title).length);var shuffleMeme=[];for(var i=0;i<Object.keys(data.title).length;i++){//   setMeme(preState => [\n//     ...preState, {media:data.media['?',i],\n//   score:data.score['?',i],\n// title:data.title['?',i]}\n//   ])\nshuffleMeme.push({media:data.media[('?',i)],score:data.score[('?',i)],title:data.title[('?',i)]});}setMeme(shuffle(shuffleMeme));if(shuffleMeme.length>0){fetch(\"/checkImage?src=\"+shuffleMeme[currentMeme].media).then(function(res){return res.json();}).then(function(isFound){console.log(isFound);if(isFound===404){setCurrentMeme(currentMeme+1);setNextMeme(currentMeme+2);console.log(\"skipped\");}});}if(shuffleMeme.length>0){fetch(\"/checkImage?src=\"+shuffleMeme[nextMeme].media).then(function(res){return res.json();}).then(function(isFound){console.log(isFound);if(isFound===404){setNextMeme(nextMeme+1);console.log(\"skipped\");}});}});};var updateData=function updateData(){fetch(\"/updateMeme\");};useEffect(function(){var currentTime=new Date().getTime();//current unix timestamp\nvar execTime=new Date().setHours(22,9,0);//API call time = today at 20:00\nvar timeLeft;if(currentTime<execTime){//it's currently earlier than 20:00\ntimeLeft=execTime-currentTime;}else{//it's currently later than 20:00, schedule for tomorrow at 20:00\ntimeLeft=execTime+WEEK_IN_MS-currentTime;}console.log(timeLeft);setTimeout(function(){updateData();setTimeout(function(){getData();},TEN_MIN_IN_MS);setInterval(function(){updateData();setTimeout(function(){getData();},TEN_MIN_IN_MS);},WEEK_IN_MS);//repeat every week\n},timeLeft);//wait until 20:00 as calculated above\n},[]);useEffect(function(){if(meme.length>0){fetch(\"/checkImage?src=\"+meme[currentMeme].media).then(function(res){return res.json();}).then(function(isFound){console.log(isFound);if(isFound===404){if(length>currentMeme+2){setCurrentMeme(currentMeme+1);setNextMeme(currentMeme+2);console.log(\"skipped\");}else{setMeme(shuffle(meme));setCurrentMeme(0);}}});}},[currentMeme]);useEffect(function(){if(meme.length>0){fetch(\"/checkImage?src=\"+meme[nextMeme].media).then(function(res){return res.json();}).then(function(isFound){console.log(isFound);if(isFound===404){if(length>nextMeme+2){setNextMeme(nextMeme+1);setCurrentMeme(nextMeme+2);console.log(\"skipped\");}else{setMeme(shuffle(meme));setNextMeme(0);}}});}},[nextMeme]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[meme[currentMeme+1]?/*#__PURE__*/_jsxs(\"div\",{style:{height:\"950px\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:displayCurrent?{height:\"950px\"}:{height:\"950px\",display:'none'},children:[/*#__PURE__*/_jsx(\"h3\",{children:meme[currentMeme].title.replace(\"fuck\",\"****\").replace(\"shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"Fuck\",\"****\").replace(\"Shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"FUCK\",\"****\").replace(\"SHIT\",\"****\").replace(\"BITCH\",\"*****\").replace(\"cunt\",\"****\").replace(\"CUNT\",\"****\").replace(\"Cunt\",\"****\").replace(\"nigger\",\"*****\").replace(\"NIGGER\",\"*****\").replace(\"Nigger\",\"******\")}),/*#__PURE__*/_jsx(\"div\",{className:\"memeBox\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"current meme\",src:meme[currentMeme].media,onError:function onError(e){if(length>currentMeme+1){if(currentMeme>nextMeme){setCurrentMeme(currentMeme+1);}console.log(meme[currentMeme].media);console.log(\"error img\");e.target.onerror=null;e.target.src=meme[currentMeme].media;}else{setMeme(shuffle(meme));setCurrentMeme(0);console.log(\"error img\");e.target.onerror=null;e.target.src=meme[currentMeme].media;}}})})]}),/*#__PURE__*/_jsxs(\"div\",{style:displayCurrent?{height:\"950px\",display:'none'}:{height:\"950px\"},children:[/*#__PURE__*/_jsx(\"h3\",{children:meme[nextMeme].title.replace(\"fuck\",\"****\").replace(\"shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"Fuck\",\"****\").replace(\"Shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"FUCK\",\"****\").replace(\"SHIT\",\"****\").replace(\"BITCH\",\"*****\").replace(\"cunt\",\"****\").replace(\"CUNT\",\"****\").replace(\"Cunt\",\"****\").replace(\"nigger\",\"*****\").replace(\"NIGGER\",\"*****\").replace(\"Nigger\",\"******\")}),/*#__PURE__*/_jsx(\"div\",{className:\"memeBox\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"next meme\",src:meme[nextMeme].media,onError:function onError(e){if(length>nextMeme+1){setNextMeme(nextMeme+1);console.log(meme[nextMeme].media);console.log(\"error img\");e.target.onerror=null;e.target.src=meme[nextMeme].media;}else{setMeme(shuffle(meme));setNextMeme(0);console.log(\"error img\");e.target.onerror=null;e.target.src=meme[nextMeme].media;}}})})]})]}):null,/*#__PURE__*/_jsx(\"span\",{className:\"timer\",children:seconds})]}),/*#__PURE__*/_jsx(\"button\",{onClick:play,style:{marginTop:1000},children:\"Boop!\"})]});}export default App;","map":{"version":3,"sources":["/Users/kevii/Desktop/git-meme-stream/meme-stream/client/src/App.js"],"names":["React","useState","useEffect","memeBGM","useSound","bellSound","App","meme","setMeme","currentMeme","setCurrentMeme","nextMeme","setNextMeme","seconds","setSeconds","displayCurrent","setDisplayCurrent","length","setLength","CLOCK","WEEK_IN_MS","TEN_MIN_IN_MS","onMusic","setOnMusic","Audio","bgm","setBgm","play","pause","loop","getData","setTimeout","media","shuffle","console","log","array","currentIndex","randomIndex","Math","floor","random","fetch","then","res","json","data","Object","keys","title","shuffleMeme","i","push","score","isFound","updateData","currentTime","Date","getTime","execTime","setHours","timeLeft","setInterval","height","display","replace","e","target","onerror","src","marginTop"],"mappings":"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","sourcesContent":["import './App.css';\nimport React, { useState, useEffect } from 'react';\nimport memeBGM from \"./assets/memeBGM.mp3\";\nimport useSound from 'use-sound';\nimport bellSound from \"./assets/bell.mp3\"\n\n\nfunction App() {\n  const [meme,setMeme] = useState([])\n  const [currentMeme,setCurrentMeme] = useState(0)\n  const [nextMeme,setNextMeme] = useState(currentMeme+1)\n  const [seconds,setSeconds] = useState(15)\n  const [displayCurrent, setDisplayCurrent] = useState(true)\n  const [length,setLength] = useState()\n  const CLOCK = 15\n  const WEEK_IN_MS = 604800000\n  const TEN_MIN_IN_MS = 600000\n  const [onMusic,setOnMusic] = useState(false)\n  const [bgm, setBgm] = useState(new Audio(memeBGM))\n\n  const play = () => {\n    if(onMusic){\n      setOnMusic(false)\n      bgm.pause()\n    }\n    else{\n      setOnMusic(true)\n      bgm.play()\n      bgm.loop = true\n    \n    }\n      \n      \n  }\n\n  useEffect(() => {\n      getData()\n  },[])\n\n\n  useEffect(() => {\n    setTimeout(() => {\n      if(seconds!==0){\n      setSeconds(seconds-1)}\n      else{\n        if(displayCurrent){\n          setDisplayCurrent(false)\n          if(length>(nextMeme+1)){\n\n            setCurrentMeme(nextMeme+1)\n            while(!meme[currentMeme].media && meme[currentMeme].media===''){\n              setCurrentMeme(nextMeme+1)\n            }\n          \n          }\n          else{\n            setMeme(shuffle(meme))\n            setCurrentMeme(0)\n          }\n\n        }\n        else{\n          setDisplayCurrent(true)\n          if(length>(currentMeme+1)){\n            setNextMeme(currentMeme+1)\n            while(!meme[nextMeme].media && meme[nextMeme].media===''){\n              setCurrentMeme(nextMeme+1)\n            }\n          \n          }\n          else{\n            setMeme(shuffle(meme))\n            setNextMeme(0)\n          }\n        }\n        setSeconds(CLOCK)\n        \n      }\n    }, 1000);\n    \n  }, [seconds])\n\n  useEffect(()=>{\n    console.log(meme)\n  },[meme])\n\n  function shuffle(array) {\n    let currentIndex = array.length\n    let randomIndex\n\n    while (currentIndex != 0) {\n\n      randomIndex = Math.floor(Math.random() * currentIndex);\n      currentIndex--;\n\n      [array[currentIndex], array[randomIndex]] = [\n        array[randomIndex], array[currentIndex]];\n    }\n    \n    return array\n      \n    }\n\n    const getData = () => {\n      fetch(\"/members\").then(\n        res => res.json()\n      )\n      .then(data => {\n        setLength(Object.keys(data.title).length)\n        let shuffleMeme = []\n        for (var i =0; i<Object.keys(data.title).length; i++){\n      //   setMeme(preState => [\n      //     ...preState, {media:data.media['?',i],\n      //   score:data.score['?',i],\n      // title:data.title['?',i]}\n      //   ])\n  \n          shuffleMeme.push({media:data.media['?',i],\n             score:data.score['?',i],\n           title:data.title['?',i]})\n  \n  \n      }\n      setMeme(shuffle(shuffleMeme))\n      if(shuffleMeme.length > 0) {\n        fetch(\"/checkImage?src=\"+shuffleMeme[currentMeme].media)\n        .then(res => {\n          return res.json()\n        })\n        .then(isFound => {\n          console.log(isFound)\n          if (isFound === 404){\n            setCurrentMeme(currentMeme+1)\n            setNextMeme(currentMeme+2)\n            console.log(\"skipped\")\n          }\n        }) \n      }\n      if(shuffleMeme.length > 0) {\n        fetch(\"/checkImage?src=\"+shuffleMeme[nextMeme].media)\n        .then(res => {\n          return res.json()\n        })\n        .then(isFound => {\n          console.log(isFound)\n          if (isFound === 404){\n            setNextMeme(nextMeme+1)\n            console.log(\"skipped\")\n          }\n        }) \n      }\n      })\n    }\n\n    const updateData = () => {\n      fetch(\"/updateMeme\")\n    }\n\n    useEffect(() => {\n\n      const currentTime = new Date().getTime();  //current unix timestamp\n      const execTime = new Date().setHours(22,9,0);  //API call time = today at 20:00\n      let timeLeft;\n      if(currentTime < execTime) {\n        //it's currently earlier than 20:00\n        timeLeft = execTime - currentTime;\n      } else {\n        //it's currently later than 20:00, schedule for tomorrow at 20:00\n        timeLeft = execTime + WEEK_IN_MS - currentTime\n      }\n      console.log(timeLeft)\n      \n      setTimeout(function() {\n\n        updateData()\n          setTimeout(function() {\n            getData()\n          }, TEN_MIN_IN_MS)\n\n        setInterval(function() {\n          updateData()\n          setTimeout(function() {\n            getData()\n          }, TEN_MIN_IN_MS)\n    \n        }, WEEK_IN_MS);  //repeat every week\n      }, timeLeft);  //wait until 20:00 as calculated above\n    },[])\n\n    useEffect(() => {\n      if(meme.length > 0) {\n      fetch(\"/checkImage?src=\"+meme[currentMeme].media)\n      .then(res => {\n        return res.json()\n      })\n      .then(isFound => {\n        console.log(isFound)\n        if (isFound === 404){\n          if(length>(currentMeme+2)){\n          setCurrentMeme(currentMeme+1)\n          setNextMeme(currentMeme+2)\n          console.log(\"skipped\")\n          }\n          else{\n            setMeme(shuffle(meme))\n            setCurrentMeme(0)\n          }\n        }\n      }) \n    }\n    },[currentMeme])\n\n    useEffect(() => {\n      if(meme.length > 0) {\n        fetch(\"/checkImage?src=\"+meme[nextMeme].media)\n        .then(res => {\n          return res.json()\n        })\n        .then(isFound => {\n          console.log(isFound)\n          if (isFound === 404){\n            if(length>(nextMeme+2)){\n              setNextMeme(nextMeme+1)\n              setCurrentMeme(nextMeme+2)\n              console.log(\"skipped\")\n            }\n            else{\n              setMeme(shuffle(meme))\n              setNextMeme(0)\n            }\n          }\n        })\n      }\n       \n    },[nextMeme])\n\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n      {meme[currentMeme+1]?        <div style={{height:\"950px\"}}>\n\n        <div  style={displayCurrent?{height:\"950px\"}:{height:\"950px\",display:'none'}}>\n            <h3>{meme[currentMeme].title.replace(\"fuck\",\"****\").replace(\"shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"Fuck\",\"****\").replace(\"Shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"FUCK\",\"****\").replace(\"SHIT\",\"****\").replace(\"BITCH\",\"*****\").replace(\"cunt\",\"****\").replace(\"CUNT\",\"****\").replace(\"Cunt\",\"****\").replace(\"nigger\",\"*****\").replace(\"NIGGER\",\"*****\").replace(\"Nigger\",\"******\")}</h3>\n            <div className='memeBox'>\n            <img alt=\"current meme\" src={meme[currentMeme].media} onError={(e) => {\n              if(length>(currentMeme+1)){\n              if(currentMeme > nextMeme){\n                setCurrentMeme(currentMeme+1)\n              }\n              \n              console.log(meme[currentMeme].media)\n              console.log(\"error img\")\n              e.target.onerror = null\n              e.target.src=meme[currentMeme].media\n            }\n            else{\n              setMeme(shuffle(meme))\n              setCurrentMeme(0)\n              console.log(\"error img\")\n              e.target.onerror = null\n              e.target.src=meme[currentMeme].media\n            }}}></img>\n            </div>\n            </div>\n\n            <div style={displayCurrent?{height:\"950px\",display:'none'}:{height:\"950px\"}}>\n            <h3>{meme[nextMeme].title.replace(\"fuck\",\"****\").replace(\"shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"Fuck\",\"****\").replace(\"Shit\",\"****\").replace(\"Bitch\",\"*****\").replace(\"FUCK\",\"****\").replace(\"SHIT\",\"****\").replace(\"BITCH\",\"*****\").replace(\"cunt\",\"****\").replace(\"CUNT\",\"****\").replace(\"Cunt\",\"****\").replace(\"nigger\",\"*****\").replace(\"NIGGER\",\"*****\").replace(\"Nigger\",\"******\")}</h3>\n            <div className='memeBox'>\n            <img alt=\"next meme\" src={meme[nextMeme].media} onError={(e) => {\n              if(length>(nextMeme+1)){\n                setNextMeme(nextMeme+1)\n                console.log(meme[nextMeme].media)\n                console.log(\"error img\")\n                e.target.onerror = null\n                e.target.src=meme[nextMeme].media\n              }\n              else{\n                setMeme(shuffle(meme))\n                setNextMeme(0)\n                console.log(\"error img\")\n                e.target.onerror = null\n                e.target.src=meme[nextMeme].media\n              }\n            }}></img>\n            </div>\n            </div>\n          </div>:null}\n        <span className=\"timer\">{seconds}</span>\n      </header>\n\n      {/* <img src={\"https://i.redd.it/rs7pju6muo881.jpg\"} \n      onError={({ currentTarget }) => {\n        currentTarget.onerror = null; // prevents looping\n        currentTarget.src=\"https://i.redd.it/u6anbsaoed381.jpg\";\n      }}\n      \n    ></img> */}\n\n<button onClick={play} style={{marginTop:1000}}>Boop!</button>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}